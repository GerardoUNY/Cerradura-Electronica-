MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ; En el programa presente se programará una cerradura electrónica.
                      00002 
                      00003 ; Los materiales para su implementación son los siguientes.
                      00004 ; Llave contacto (Puede ser reemplazado por un switch)
                      00005 ; Teclado 4x4
                      00006 ; LCD 16x2
                      00007 ; Pic16f877A (Con sus componentes: oscilador y condensadores)
                      00008 ; Servomotor Sg90
                      00009 
                      00010 ;---- Descripción: La cerradura electrónica, se encargará de abrir una puerta
                      00011 ; despues de haber ingresado correctamente la clave en el teclado numérico 4x4
                      00012 
                      00013 ; Se constará de una llave contacto, el cual tendrá que activar la secuencia de
                      00014 ; apertura de la puerta. (Servomotor desbloquea la puerta)
                      00015 
                      00016 ; Explicado.
                      00017 
                      00018 ; - Al principio la puerta está completamente cerrada
                      00019 ; - Llega un usuario, ingresa la clave de 4 digitos
                      00020 ; - Luego de ingresar la clave, girará la llave contacto.
                      00021 ; - Si la clave fué correcta, entonces se iniciará la secuencia de apertura
                      00022 ; - La secuencia consta de hacer girar a un servomotor 90°
                      00023 
                      00024 ; La explicación y demostración en la web. www.rodrigocarita.com en la sección
                      00025 ; sistemas digitales 2 / teclado 4x4. También en youtube.
                      00026 ;-------------------------------- Cabecera ------------------------------------
Warning[205]: Found directive in column 1. (INCLUDE)
                      00027 INCLUDE <P16F877A.INC>
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F877A processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2014 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00566         LIST
Warning[205]: Found directive in column 1. (LIST)
                      00028 LIST P=16F877A
Warning[205]: Found directive in column 1. (INCLUDE)
                      00029 INCLUDE <mimacro.INC> ;Incluimos la macro
                      00001 ;;: :::::::::::::::::::::: www.rodrigocarita.com ::::::::::::::::::::::::::::::::::::::
                      00002 ; Macro de comandos y librerías para el Pic16f877A
                      00003 ; archivo : mimacro.INC
                      00004 ; Versión : 1.2
                      00005 ; ------------------------------------------------------------------------------
  00000005            00006 puertoa EQU PORTA
  00000006            00007 puertob EQU PORTB
  00000007            00008 puertoc EQU PORTC
  00000008            00009 puertod EQU PORTD
  00000009            00010 puertoe EQU PORTE
                      00011 ;////////////////////////////////////////////
                      00012 
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00013 encender macro pin,puerto
                      00014     bsf puerto,pin
                      00015     endm
                      00016 apagar macro pin,puerto
                      00017     bcf puerto,pin
                      00018     endm
                      00019 SETF macro registr0
                      00020         MOVLW d'255'
                      00021         MOVWF registr0
Warning[205]: Found directive in column 1. (endm)
                      00022 endm    
                      00023 ;...................................................................................................... 
                      00024 cargarvalor macro valor,registro
                      00025         MOVLW valor
                      00026         MOVWF registro
Warning[205]: Found directive in column 1. (endm)
                      00027 endm
                      00028 
                      00029 copiarregistro macro registrode,registrohacia
                      00030         MOVF registrode,0
                      00031         MOVWF registrohacia
Warning[205]: Found directive in column 1. (endm)
                      00032 endm
                      00033 ;.....................................................................................................  
                      00034 ;//////////////////////////////////
                      00035 
                      00036 banco macro payasito
                      00037 ;banco 0
                      00038 if payasito==0
                      00039 BCF STATUS, RP0
                      00040 BCF STATUS, RP1
                      00041 endif
                      00042 
                      00043 if payasito==1
                      00044 ;banco 1
                      00045 BSF STATUS, RP0
                      00046 BCF STATUS, RP1
                      00047 endif
                      00048 
                      00049 if payasito==2
                      00050 ;banco 2
                      00051 BCF STATUS, RP0
                      00052 BSF STATUS, RP1
                      00053 endif
                      00054 
                      00055 if payasito==3
                      00056 ;banco 3
                      00057 BSF STATUS, RP0
                      00058 BSF STATUS, RP1
                      00059 endif
                      00060 
Warning[205]: Found directive in column 1. (endm)
                      00061 endm
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00062 
                      00063 ;//////////////////////////////////////////// compara entre registros y salta si son iguales /////////
                      00064 csir             macro  registro1,registro2,direcc
                      00065                          movf   registro2,0
                      00066                          subwf  registro1,0
                      00067                          btfsc  STATUS,Z
                      00068                          goto   direcc
Warning[205]: Found directive in column 1. (endm)
                      00069 endm
                      00070 ;//////////////////////////////////////////// compara entre registros y salta si no son iguales ////////
                            /
                      00071 csnir            macro  registro1,registro2,direcc
                      00072                          movf   registro2,0
                      00073                          subwf  registro1,0
                      00074                          btfsc  STATUS,Z
                      00075                          goto   direcc
Warning[205]: Found directive in column 1. (endm)
                      00076 endm
                      00077 
                      00078 ; Compara registro con un valor y se va a la rutina direccion si son iguales
                      00079 
                      00080 csi          macro      registro1,valor,direccion
                      00081                 movlw   valor
                      00082                  subwf  registro1,0
                      00083                  btfsc  STATUS,Z
                      00084                  goto   direccion
Warning[205]: Found directive in column 1. (endm)
                      00085 endm
                      00086 ;Compara registro con un valor y se va a la rutina si no son iguales
                      00087 csni macro registro1,valor,direccion
                      00088                         movlw valor
                      00089                         subwf registro1,0
                      00090                         btfss STATUS,Z
                      00091                         goto direccion
Warning[205]: Found directive in column 1. (endm)
                      00092 endm
                      00093 
                      00094 ; Compara registro con un valor y si  se cumple la condicion Reg>valor se va a la subrutina
                      00095 mayorque macro registro1,valor ,subrutina
                      00096                 MOVLW valor
                      00097                 SUBWF registro1,0
                      00098                 BTFSC STATUS,C
                      00099                 GOTO subrutina
Warning[205]: Found directive in column 1. (endm)
                      00100 endm
                      00101 ; Compara registro con un valor y si  se cumple la condicion Reg<valor se va a la subrutina
                      00102 menorque macro registro1,valor ,subrutina
                      00103                 MOVLW valor
                      00104                 SUBWF registro1,0
                      00105                 BTFSS STATUS,C
                      00106                 GOTO subrutina
Warning[205]: Found directive in column 1. (endm)
                      00107 endm
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00108 ; Compara registro con un valor y si se cumple la condicion Reg>Reg2se va a la subrutina
                      00109 mayorquereg macro registro1,registro2 ,subrutina
                      00110                 MOVF registro2,0
                      00111                 SUBWF registro1,0
                      00112                 BTFSC STATUS,C
                      00113                 GOTO subrutina
Warning[205]: Found directive in column 1. (endm)
                      00114 endm
                      00115 ; Compara registro con un valor y si se cumple la condicion Reg<Reg2 se va a la subrutina
                      00116 menorquereg macro registro1,registro2,subrutina
                      00117                 MOVF registro2,0
                      00118                 SUBWF registro1,0
                      00119                 BTFSS STATUS,C
                      00120                 GOTO subrutina
Warning[205]: Found directive in column 1. (endm)
                      00121 endm
                      00122 
                      00123 ; /////////////////////////////////// Para display 7 segmentos //////////////////////////////
                      00124 enviaradisplay macro numnum
                      00125         MOVLW numnum
                      00126         CALL TABLAANODO
                      00127         MOVWF PORTD
Warning[205]: Found directive in column 1. (endm)
                      00128 endm
                      00129         
                      00130 enviarcdisplay macro numnum
                      00131         MOVLW numnum
                      00132         CALL TABLACATODO
                      00133         MOVWF PORTD
Warning[205]: Found directive in column 1. (endm)
                      00134 endm
                      00135 
                      00136 registroadisplay macro numnum
                      00137         MOVF numnum,0
                      00138         CALL TABLAANODO
                      00139         MOVWF PORTD
Warning[205]: Found directive in column 1. (endm)
                      00140 endm
                      00141 
                      00142 registrocdisplay macro numnum
                      00143         MOVF numnum,0
                      00144         CALL TABLACATODO
                      00145         MOVWF PORTD
Warning[205]: Found directive in column 1. (endm)
                      00146 endm
                      00147 ;...............................................///////////////////////////////////.....................
                            ..../////////////////////////
                      00148 on_lib_retardos_ms macro
                      00149         CALL CONFTMR0TEMP
Warning[205]: Found directive in column 1. (endm)
                      00150 endm
                      00151 
                      00152 retardo_ms macro valor
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00153         MOVLW valor
                      00154         CALL RETARDOLIBRE_mS
Warning[205]: Found directive in column 1. (endm)
                      00155 endm
                      00156 
                      00157 ;Conversor de Binario a BCD. La respuesta se guarda en registros bcd_unidad, bcd_decena, bcd_centena
                      00158 convertir_a_bcd macro registro
                      00159         MOVF registro,0
                      00160         CALL binario_a_bcd
Warning[205]: Found directive in column 1. (endm)
                      00161 endm
                      00162 
                      00163 ;Codigo de macro para Retardos
                      00164 milisegundo      macro X
                      00165                          movlw X
                      00166                          call  milisegundos
                      00167                          endm
                      00168 segundo          macro X
                      00169                          movlw X
                      00170                          call  segundos
                      00171                          endm
                      00172 ;//////////////////////////////////////////////////////////////////////////////
                      00173 ; Macro para LCD Información sobre comandos en www.rodrigocarita.com
                      00174 ; Para controlar la pantalla LCD 2x16
                      00175 
                      00176 iniciarlcd macro             ;Con esto desarrollamos la secuencia de inicio               
                      00177            call  Inicio_lcd
                      00178            endm
                      00179 escribir   macro valcaracter       ;Con este comando enviaremos un caracter a la pantalla
                      00180            movlw valcaracter
                      00181            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
                      00182            endm
                      00183 escribirreg macro registro4                     ;Con este comando enviaremos el valor de un registro a l
                            a pantalla
                      00184          movlw .48
                      00185         addwf registro4,0
                      00186          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
                      00187            endm
                      00188 escribirregistro macro regREG3d     ;Subrutina para escribir en el LCD registro de 3 dígitos
                      00189                    MOVF regREG3d,0
                      00190                    CALL PARAESCR1B1RREGISTRO
Warning[205]: Found directive in column 1. (endm)
                      00191 endm
                      00192 escribirmensaje macro
                      00193                         CLRF indice
                      00194                         SEcuENCIASUBcar1
                      00195                         MOVF indice,0
                      00196                         CALL aasdd
                      00197                         MOVWF NumCadena
                      00198                         csi NumCadena,.255,FUERALIM1T3
                      00199                         MOVF NumCadena,0
                      00200                         call  ESCRIBIRCARACTER
                      00201                         INCF indice,1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00202                         GOTO SEcuENCIASUBcar1
Warning[205]: Found directive in column 1. (endm)
                      00203 endm               
                      00204            
                      00205 ;Aquí las macros para manipulación del cursor //////////////////////////////////////////
                      00206 cursor_on macro
                      00207                 movlw on_display_cursor_blink ;Enciende el cursor y su parpadeo
                      00208         CALL  ESCRIBIRCOMANDO
                      00209                 endm
                      00210 cursor_off macro
                      00211                 movlw solo_display        ;Apaga el cursor y muestra solamente el display
                      00212         CALL  ESCRIBIRCOMANDO
                      00213                 endm
                      00214 cursor_izquierda macro
                      00215                 movlw mover_cursor_izquierda ;Mueve el cursor a la derecha
                      00216         call  ESCRIBIRCOMANDO
                      00217                 endm
                      00218 cursor_derecha macro
                      00219                 movlw mover_cursor_derecha ;Mueve el cursor a la izquierda
                      00220         call  ESCRIBIRCOMANDO
                      00221                 endm
                      00222            
                      00223 fila_enter     macro    ;Saltará de línea a la segunda fila
                      00224            movlw salto_enter
                      00225            call  ESCRIBIRCOMANDO
Warning[205]: Found directive in column 1. (endm)
                      00226 endm
                      00227 fila_home macro
                      00228                 movlw home_inicio
                      00229                 call ESCRIBIRCOMANDO
Warning[205]: Found directive in column 1. (endm)
                      00230 endm
                      00231 ;//////////////////////////////////////////////////////
                      00232 ;//////////////////////////////////////// creado para la escritura en LCD mediante textos predeterminado
                            s.///////////
                      00233 mensaje macro  x
                      00234         if x==.1
                      00235         call SubirCarActer1
                      00236         endif
                      00237         if x==.2
                      00238         call SubirCarActer2
                      00239         endif
                      00240                 if x==.3
                      00241         call SubirCarActer3
                      00242         endif
                      00243                 if x==.4
                      00244         call SubirCarActer4
                      00245         endif
                      00246                 if x==.5
                      00247         call SubirCarActer5
                      00248         endif
                      00249                 if x==.6
                      00250         call SubirCarActer6
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00251         endif
                      00252                 if x>.6
                      00253                 ERROR "No hay mensaje predeterminado para el valor"
                      00254                 MESSG "Revisa el comando mensjae .x"
                      00255                 endif
                      00256         endm
                      00257 
                      00258 ;Se pueden agregar más, respetando la estructura de condicionales
                      00259 
                      00260 ;/////////////////////////////////////////////////////////////////////////////////////
                      00261 
                      00262 
                      00263 
                      00264 ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
                            \
                      00265 ;\\\\\\\\\\\\\\\\\\\\\Manipulación del cursor solamente para pantallas de 20x4 /////////////////////////
                            ///
                      00266 ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
                      00267 
                      00268 ir_a_fila macro filaseleccionada
                      00269 
                      00270         if filaseleccionada==1
                      00271                 movlw home_inicio
                      00272                 call ESCRIBIRCOMANDO
                      00273         endif
                      00274         if filaseleccionada==2
                      00275                 movlw home_inicio
                      00276                 call ESCRIBIRCOMANDO
                      00277                 movlw salto_enter
                      00278         call ESCRIBIRCOMANDO
                      00279         endif
                      00280         if filaseleccionada==3
                      00281                 movlw 0x94
                      00282                 call ESCRIBIRCOMANDO
                      00283         endif
                      00284         if filaseleccionada==4
                      00285                 movlw 0xD4
                      00286                 call ESCRIBIRCOMANDO
                      00287         endif
                      00288         if filaseleccionada>4
                      00289                 ERROR "Has sobrepasado la cantidad de filas a usar"
                      00290                 MESSG "Revisa el comando ir_a_fila que el valor sea"
                      00291                 MESSG "de 1 a 4 solamente."
                      00292         endif
Warning[205]: Found directive in column 1. (endm)
                      00293 endm
                      00294 
                      00295 
                      00296 ; ///////////////////////Comando adicional /////////////////////////////////////////////////////////////
                            ///////////
                      00297 ;/////////////////////////////Para ir a un punto especifico del LCD ////////////////////////////////////
                            //////////
                      00298 ;/////////////////////////////////Solo para LCD20x4 ////////////////////////////////////////////////////
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            //////////
                      00299 lcdfc macro lcdvalorf,lcdvalorc
                      00300 
                      00301         ;/// Para seleccionar la fila
                      00302         if lcdvalorf==1
                      00303         MOVLW lcdvalorc
                      00304         MOVWF ubicacionlcdfcr
                      00305         DECF ubicacionlcdfcr,1
                      00306         MOVlW 0X80
                      00307         ADDWF ubicacionlcdfcr,0
                      00308         call ESCRIBIRCOMANDO
                      00309         endif
                      00310         if lcdvalorf==2
                      00311         MOVLW lcdvalorc
                      00312         MOVWF ubicacionlcdfcr
                      00313         DECF ubicacionlcdfcr,1
                      00314         MOVlW 0XC0
                      00315         ADDWF ubicacionlcdfcr,0
                      00316         call ESCRIBIRCOMANDO
                      00317         endif
                      00318         if lcdvalorf==3
                      00319         MOVLW lcdvalorc
                      00320         MOVWF ubicacionlcdfcr
                      00321         DECF ubicacionlcdfcr,1
                      00322         MOVlW 0X94
                      00323         ADDWF ubicacionlcdfcr,0
                      00324         call ESCRIBIRCOMANDO
                      00325         endif
                      00326         if lcdvalorf==4
                      00327         MOVLW lcdvalorc
                      00328         MOVWF ubicacionlcdfcr
                      00329         DECF ubicacionlcdfcr,1
                      00330         MOVlW 0XD4
                      00331         ADDWF ubicacionlcdfcr,0
                      00332         call ESCRIBIRCOMANDO
                      00333         endif
                      00334         ;Para seleccionar la columna
                      00335 
Warning[205]: Found directive in column 1. (endm)
                      00336 endm
                      00337 
                      00338 ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\               
                      00339 
                      00340 ;Desde aquí los comandos para manipulación del display //////////////////////////////////////////
Warning[207]: Found label after column 1. (borralcd)
                      00341  borralcd  macro                ;Borra todo lo de la pantalla
                      00342            movlw limpiar_lcd
                      00343            call  ESCRIBIRCOMANDO
                      00344            endm
                      00345 borrarfila macro valor
                      00346         lcdfc valor,.1
                      00347         CALL subp4arab0rf1l     
                      00348         lcdfc valor,.1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (endm)
                      00349 endm               
Warning[207]: Found label after column 1. (desplazaderecha)
                      00350  desplazaderecha  macro                 ;Mueve todo lo escrito en la pantalla 1 a la derecha
                      00351                   movlw  mover_pantalla_derecha
                      00352                   call   ESCRIBIRCOMANDO             
                      00353                   endm
Warning[207]: Found label after column 1. (desplazaizquierda)
                      00354  desplazaizquierda  macro       ;Mueve todo lo escrito en la pantalla 1 a la izquierda         
                      00355                                 movlw  mover_pantalla_izquierda
                      00356                                 call   ESCRIBIRCOMANDO             
                      00357                                 endm
Warning[207]: Found label after column 1. (apagarpantalla)
                      00358  apagarpantalla macro
                      00359                                 movlw apagar_el_display
                      00360                                 call ESCRIBIRCOMANDO
                      00361  endm
Warning[207]: Found label after column 1. (encenderpantalla)
                      00362   encenderpantalla macro
                      00363                                 movlw solo_display
                      00364                                 call ESCRIBIRCOMANDO
                      00365  endm
                      00366  
                      00367  ;/////////////////////////////////////////////////////////////////////////////////
                      00368  ;/////////////////////////////////////////////////////////////////////////////////
                      00369  ;Para enviar 1 pulso de duración programable
                      00370  ;Requiere de la Librería RETARDOS.ASM
                      00371  
Warning[207]: Found label after column 1. (PULSOSUB)
                      00372  PULSOSUB macro pinp,registrop,duracion
                      00373                 BSF registrop,pinp
                      00374                 milisegundo duracion
                      00375                 BCF registrop,pinp
                      00376  endm
                      00377  ;///////////////////// Operaciones matemáticas //////////////////////////////////
                      00378  ;//////////////////////////////////////////////////////
                      00379 sumarreg macro registro1,registro2
                      00380    movf registro1,0
                      00381    movwf Reg15tr01
                      00382    movf registro2,0
                      00383    movwf Reg15tr02
                      00384    call Separaciondigit05
                      00385    call ParaSumarReg1str0s
Warning[205]: Found directive in column 1. (endm)
                      00386 endm
                      00387 
                      00388 restarreg macro registrox1,registrox2; Hay que asegurarse que el registro 1 sea mayor al registro2.
                      00389    movf registrox1,0
                      00390    movwf Reg15tr01
                      00391    movf registrox2,0
                      00392    movwf Reg15tr02
                      00393    call ParaRestarReg1str0s2
Warning[205]: Found directive in column 1. (endm)
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00394 endm
                      00395  
                      00396 multiplicarreg macro registrom1,registrom2
                      00397    movf registrom1,0
                      00398    movwf Reg15tr01
                      00399    movf registrom2,0
                      00400    movwf Reg15tr02
                      00401    call Separaciondigit05
                      00402    call ParaMultiplicarReg1str0s
Warning[205]: Found directive in column 1. (endm)
                      00403 endm 
                      00404 
                      00405 crearreg macro registroc1,registroc2,registroc3
                      00406    movf registroc1,0
                      00407    movwf Reg15tr01
                      00408    movf registroc2,0
                      00409    movwf Reg15tr02
                      00410    movf registroc3,0
                      00411    movwf Reg15tr03
                      00412    call ParaCrearReg1str0
Warning[205]: Found directive in column 1. (endm)
                      00413 endm
                      00414 
                      00415 ;///////////////////////////////////////////////////////////////////////////////////////////////////////
                            /////
                      00416 ;//////////////////////////////////// Para módulo HC-SR04 //////////////////////////////////////////////
                            /////
                      00417 ;///////////////////////////////////////////////////////////////////////////////////////////////////////
                            /////  
                      00418 
                      00419 iniciar_hcsr04  macro
                      00420         banco 1
                      00421         MOVLW b'00000111' ; Timer 0 como temporizador y escala 256
                      00422         MOVWF OPTION_REG  ; Cargamos la configuración en el TMR0
                      00423         banco 0
                      00424         BCF TRIGGER
                      00425         MOVLW .88 ;Cargamos el valor de ajuste de medida 51.2/58 = 0.88
                      00426          MOVWF Ajust3d1st ;En la variable de ajuste "Ajust3d1st"
Warning[205]: Found directive in column 1. (endm)
                      00427 endm
                      00428 
                      00429 medir_ultrasonico macro Rresulm3edid4
                      00430         CALL Med1rdiist4nc1ia  ;Llama a la subrutina de medición
                      00431         MOVF valaux04,0        ;Extrae el valor de la respuesta en W 
                      00432         MOVWF Rresulm3edid4    ;Guarda la respuesta en el indicador de registro 
Warning[205]: Found directive in column 1. (endm)
                      00433 endm
                      00434 
                      00435 ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
                      00436  ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ Para teclado 4x4         \\\\\\\\\\\\\\\\\\\\\\\\\\\\
                      00437  ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
                      00438  
                      00439 iniciar_teclado macro
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00440         CALL IN1ci0t3cla4do
Warning[205]: Found directive in column 1. (endm)
                      00441 endm
                      00442 
                      00443 leertecla macro
                      00444         BSF Sit3cl4pus,0
                      00445         CALL Tttest3aTecld0o
Warning[205]: Found directive in column 1. (endm)
                      00446 endm
                      00447 
                      00448 irsitecla macro subrutdepulso
                      00449         BCF Sit3cl4pus,0
                      00450         CALL Tttest3aTecld0o
                      00451         MOVF tekl4pul5,0
                      00452         BTFSS Hhayrt3cla,0
                      00453         GOTO subrutdepulso
Warning[205]: Found directive in column 1. (endm)
                      00454 endm
                      00455 
                      00456 llamarsitecla macro subrutdepulso
                      00457         BCF Sit3cl4pus,0
                      00458         CALL Tttest3aTecld0o
                      00459         MOVF tekl4pul5,0
                      00460         BTFSS Hhayrt3cla,0
                      00461         CALL subrutdepulso
Warning[205]: Found directive in column 1. (endm)
                      00462 endm
                      00463 
                      00464 ; ///////////////////////////////-------------------------//////////////////////////////////////////////
                            ////
Warning[205]: Found directive in column 1. (__config)
2007   3F32           00030 __config 0x3f32 ; Este es un comando de fusibles, lo estudiaremos más adelante.
                      00031 ;------------------------------------------------------------------------------
                      00032 ;----------------------------- Variables --------------------------------------
                      00033 #DEFINE PUERTA PORTC,6 ;Definimos el pin donde está conectada la puerta (LED)
                      00034 #DEFINE LLAVE PORTC,1  ;Definimos el pin donde está conectada la llave (Switch)
                      00035 
Warning[205]: Found directive in column 1. (CBLOCK)
                      00036 CBLOCK 0x20 ;Bloque de variables y memorias.
  00000020            00037 teclapulsada ;Variable donde se guardaremos la 1ra tecla pulsada
  00000021            00038 teclapulsada2 ;Variable donde se guardaremos la 2da tecla pulsada
  00000022            00039 teclapulsada3 ;Variable donde se guardaremos la 3ra tecla pulsada
  00000023            00040 teclapulsada4 ;Variable donde se guardaremos la 4ta tecla pulsada
Warning[205]: Found directive in column 1. (ENDC)
                      00041 ENDC        ;Finalizamos bloque
                      00042 ;-------------------------------------------------------------------------------
                      00043 ;-------------------------  Configuraciones  -----------------------------------
Warning[205]: Found directive in column 1. (ORG)
                      00044 ORG 0;
                      00045 
Warning[206]: Found call to macro in column 1. (banco)
                      00046 banco 1         ;Nos vamos al banco 1
                          M ;banco 0
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (if)
                          M if 1==0
                          M BCF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==1
                          M ;banco 1
Warning[203]: Found opcode in column 1. (BSF)
0000   1683               M BSF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
0001   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[203]: Found opcode in column 1. (BCF)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0002   1307           00047 BCF TRISC,6     ;Declaramos el pin 6 del puerto C como salida (LED o Puerta)
Warning[203]: Found opcode in column 1. (BSF)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0003   1487           00048 BSF TRISC,1     ;Declaramos el pin 1 del puerto C como entrada (Switch o Llave)
Warning[206]: Found call to macro in column 1. (banco)
                      00049 banco 0         ;Nos vamos al banco 0
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 0==0
Warning[203]: Found opcode in column 1. (BCF)
0004   1283               M BCF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
0005   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==1
                          M ;banco 1
                          M BSF STATUS, RP0
                          M BCF STATUS, RP1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
                      00050 ;------------------------------------------------------------------------------
                      00051 ;---------------------------- Programa Principal ------------------------------
Warning[203]: Found opcode in column 1. (BCF)
0006   1307           00052 BCF PUERTA      ; Apagamos el bit de puerta (Puerta cerrada)
Warning[206]: Found call to macro in column 1. (iniciarlcd)
                      00053 iniciarlcd       ; Iniciamos el LCD conectado al puerto D
0007   2???               M            call  Inicio_lcd
Warning[206]: Found call to macro in column 1. (cursor_off)
                      00054 cursor_off       ; Apagamos el parpadeo del cursor
0008   300C               M                 movlw solo_display        ;Apaga el cursor y muestra solamente el display
0009   2???               M         CALL  ESCRIBIRCOMANDO
Warning[206]: Found call to macro in column 1. (iniciar_teclado)
                      00055 iniciar_teclado  ; Iniciamos el teclado conectado al puerto B
000A   2???               M         CALL IN1ci0t3cla4do
Warning[203]: Found opcode in column 1. (CALL)
000B   2???           00056 CALL ESCRIBETITULO ;Llamamos a la subrutina para escribir el título
Warning[203]: Found opcode in column 1. (CALL)
000C   2???           00057 CALL ESCRIBEPARTE2 ; Llamamos a la subrutina para escribir (Clave: )
                      00058 
                      00059 ;{ Desde aquí viene el bucle principal
000D                  00060 PROGRAMA
Warning[203]: Found opcode in column 1. (BTFSC)
000D   1887           00061 BTFSC LLAVE  ;No podemos arrancar el programa, hasta que la llave esté cerrada.
Warning[203]: Found opcode in column 1. (GOTO)
000E   2???           00062 GOTO PROGRAMA
Warning[206]: Found call to macro in column 1. (lcdfc)
                      00063 lcdfc .2,.8 ;Posicionamos el cursor en la fila 2, columna 8
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .2==1
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X80
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if .2==2
000F   3008               M         MOVLW .8
0010   00AD               M         MOVWF ubicacionlcdfcr
0011   03AD               M         DECF ubicacionlcdfcr,1
0012   30C0               M         MOVlW 0XC0
0013   072D               M         ADDWF ubicacionlcdfcr,0
0014   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==3
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==4
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
                      00064 
Warning[206]: Found call to macro in column 1. (leertecla)
                      00065 leertecla    ;Leemos la primeratecla
0015   1426               M         BSF Sit3cl4pus,0
0016   2???               M         CALL Tttest3aTecld0o
Warning[203]: Found opcode in column 1. (MOVWF)
0017   00A0           00066 MOVWF teclapulsada  ; Lo guardamos en el registro teclapulsada
Warning[206]: Found call to macro in column 1. (escribirreg)
                      00067 escribirreg teclapulsada ;Escribirmos la tecla en el teclado
0018   3030               M          movlw .48
0019   0720               M         addwf teclapulsada,0
001A   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
Warning[206]: Found call to macro in column 1. (milisegundo)
                      00068 milisegundo .250 ;Esperamos 200 milisegundos antirebote
001B   30FA               M                          movlw .250
001C   2???               M                          call  milisegundos
                      00069 
Warning[206]: Found call to macro in column 1. (leertecla)
                      00070 leertecla    ;Leemos la segunda tecla
001D   1426               M         BSF Sit3cl4pus,0
001E   2???               M         CALL Tttest3aTecld0o
Warning[203]: Found opcode in column 1. (MOVWF)
001F   00A1           00071 MOVWF teclapulsada2  ; Lo guardamos en el registro teclapulsada
Warning[206]: Found call to macro in column 1. (escribirreg)
                      00072 escribirreg teclapulsada2 ;Escribirmos la tecla en el teclado
0020   3030               M          movlw .48
0021   0721               M         addwf teclapulsada2,0
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0022   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
Warning[206]: Found call to macro in column 1. (milisegundo)
                      00073 milisegundo .250 ;Esperamos 200 milisegundos antirebote
0023   30FA               M                          movlw .250
0024   2???               M                          call  milisegundos
                      00074 
Warning[206]: Found call to macro in column 1. (leertecla)
                      00075 leertecla    ;Leemos la tercera tecla
0025   1426               M         BSF Sit3cl4pus,0
0026   2???               M         CALL Tttest3aTecld0o
Warning[203]: Found opcode in column 1. (MOVWF)
0027   00A2           00076 MOVWF teclapulsada3  ; Lo guardamos en el registro teclapulsada
Warning[206]: Found call to macro in column 1. (escribirreg)
                      00077 escribirreg teclapulsada3 ;Escribirmos la tecla en el teclado
0028   3030               M          movlw .48
0029   0722               M         addwf teclapulsada3,0
002A   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
Warning[206]: Found call to macro in column 1. (milisegundo)
                      00078 milisegundo .250 ;Esperamos 200 milisegundos antirebote
002B   30FA               M                          movlw .250
002C   2???               M                          call  milisegundos
                      00079 
Warning[206]: Found call to macro in column 1. (leertecla)
                      00080 leertecla    ;Leemos la cuarta tecla
002D   1426               M         BSF Sit3cl4pus,0
002E   2???               M         CALL Tttest3aTecld0o
Warning[203]: Found opcode in column 1. (MOVWF)
002F   00A3           00081 MOVWF teclapulsada4  ; Lo guardamos en el registro teclapulsada
Warning[206]: Found call to macro in column 1. (escribirreg)
                      00082 escribirreg teclapulsada4 ;Escribirmos la tecla en el teclado
0030   3030               M          movlw .48
0031   0723               M         addwf teclapulsada4,0
0032   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
Warning[206]: Found call to macro in column 1. (milisegundo)
                      00083 milisegundo .250 ;Esperamos 200 milisegundos antirebote
0033   30FA               M                          movlw .250
0034   2???               M                          call  milisegundos
                      00084 
                      00085 ;----------------------- Sección de la contraseña: 4621 --------------------
Warning[206]: Found call to macro in column 1. (csni)
                      00086 csni teclapulsada,.4, DENEGADO ;Si al consultar la contraseña, 1 digito falla
0035   3004               M                         movlw .4
0036   0220               M                         subwf teclapulsada,0
0037   1D03               M                         btfss STATUS,Z
0038   2???               M                         goto DENEGADO
Warning[206]: Found call to macro in column 1. (csni)
                      00087 csni teclapulsada2,.6, DENEGADO ;automaticamente se irá a la subrutina
0039   3006               M                         movlw .6
003A   0221               M                         subwf teclapulsada2,0
003B   1D03               M                         btfss STATUS,Z
003C   2???               M                         goto DENEGADO
Warning[206]: Found call to macro in column 1. (csni)
                      00088 csni teclapulsada3,.2, DENEGADO ; llamada denegado
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003D   3002               M                         movlw .2
003E   0222               M                         subwf teclapulsada3,0
003F   1D03               M                         btfss STATUS,Z
0040   2???               M                         goto DENEGADO
Warning[206]: Found call to macro in column 1. (csni)
                      00089 csni teclapulsada4,.1, DENEGADO
0041   3001               M                         movlw .1
0042   0223               M                         subwf teclapulsada4,0
0043   1D03               M                         btfss STATUS,Z
0044   2???               M                         goto DENEGADO
                      00090 ;----------------------- Secuencia de apertura ------------------------------
                      00091 ;Si se ha llegado aquí es porque la contraseña es correcta. Entonces se crea una
                      00092 ;subrutina especial para la secuencia.
Warning[203]: Found opcode in column 1. (CALL)
0045   2???           00093 CALL PERMITIDO  ;Aquí estará la subrutina de apertura de la puerta.
Warning[203]: Found opcode in column 1. (GOTO)
0046   2???           00094 GOTO PROGRAMA
                      00095 ;} Finalizó el bucle principal
                      00096 
                      00097 ;-------------------- Sección de subrutina principal ------------------------
                      00098 
0047                  00099 DENEGADO ;aquí empieza la subrutina en caso la contraseña sea erronea
                      00100 ;Primer paso será limpiar lo escrito
Warning[206]: Found call to macro in column 1. (lcdfc)
                      00101 lcdfc .2,.8 ;Posicionamos el cursor en la fila 2, columna 8
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .2==1
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X80
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==2
0047   3008               M         MOVLW .8
0048   00AD               M         MOVWF ubicacionlcdfcr
0049   03AD               M         DECF ubicacionlcdfcr,1
004A   30C0               M         MOVlW 0XC0
004B   072D               M         ADDWF ubicacionlcdfcr,0
004C   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==3
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==4
                          M         MOVLW .8
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
Warning[206]: Found call to macro in column 1. (escribir)
                      00102 escribir ' '
004D   3020               M            movlw ' '
004E   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00103 escribir ' '
004F   3020               M            movlw ' '
0050   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00104 escribir ' '
0051   3020               M            movlw ' '
0052   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00105 escribir ' '
0053   3020               M            movlw ' '
0054   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[203]: Found opcode in column 1. (GOTO)
0055   2???           00106 GOTO PROGRAMA ; Reiniciamos el programa
                      00107 
0056                  00108 PERMITIDO ;Aquí la secuencia de cosas que sucederan cuando sea correcta
                      00109 
Warning[203]: Found opcode in column 1. (CALL)
0056   2???           00110 CALL ESCRIBEPARTE3 ;Escribimos el mensaje de correcto.
Warning[203]: Found opcode in column 1. (BTFSS)
0057   1C87           00111 BTFSS LLAVE ;Esperamos a que se abra la llave
Warning[203]: Found opcode in column 1. (GOTO)
0058   2???           00112 GOTO $-1    ;Seguimos esperando
Warning[203]: Found opcode in column 1. (BSF)
0059   1707           00113 BSF PUERTA  ;Abrimos la Puerta
                      00114 
Warning[203]: Found opcode in column 1. (BTFSC)
005A   1887           00115 BTFSC LLAVE ;Testeamos si se cerró la llave (osea la puerta)
Warning[203]: Found opcode in column 1. (GOTO)
005B   2???           00116 GOTO $-1 ;Mantenemos la puerta abierta, hasta que se cierre la llave
Warning[203]: Found opcode in column 1. (BCF)
005C   1307           00117 BCF PUERTA ; Cerramos la puerta
Warning[206]: Found call to macro in column 1. (borrarfila)
                      00118 borrarfila .1 ;Borramos el mensaje de la fila 1, para escribir denuevo el otro
                          M         lcdfc .1,.1
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .1==1
005D   3001               M         MOVLW .1
005E   00AD               M         MOVWF ubicacionlcdfcr
005F   03AD               M         DECF ubicacionlcdfcr,1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0060   3080               M         MOVlW 0X80
0061   072D               M         ADDWF ubicacionlcdfcr,0
0062   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==2
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XC0
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==3
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==4
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
0063   2???               M         CALL subp4arab0rf1l     
                          M         lcdfc .1,.1
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .1==1
0064   3001               M         MOVLW .1
0065   00AD               M         MOVWF ubicacionlcdfcr
0066   03AD               M         DECF ubicacionlcdfcr,1
0067   3080               M         MOVlW 0X80
0068   072D               M         ADDWF ubicacionlcdfcr,0
0069   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==2
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XC0
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==3
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==4
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
Warning[203]: Found opcode in column 1. (CALL)
006A   2???           00119 CALL ESCRIBETITULO ; Escribimos denuevo el título
Warning[206]: Found call to macro in column 1. (lcdfc)
                      00120 lcdfc .2,.8 ;Posicionamos el cursor en la fila 2, columna 8
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .2==1
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X80
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==2
006B   3008               M         MOVLW .8
006C   00AD               M         MOVWF ubicacionlcdfcr
006D   03AD               M         DECF ubicacionlcdfcr,1
006E   30C0               M         MOVlW 0XC0
006F   072D               M         ADDWF ubicacionlcdfcr,0
0070   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==3
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==4
                          M         MOVLW .8
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         ;Para seleccionar la columna
                          M 
Warning[206]: Found call to macro in column 1. (escribir)
                      00121 escribir ' '
0071   3020               M            movlw ' '
0072   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00122 escribir ' '
0073   3020               M            movlw ' '
0074   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00123 escribir ' '
0075   3020               M            movlw ' '
0076   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00124 escribir ' '
0077   3020               M            movlw ' '
0078   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[203]: Found opcode in column 1. (RETURN)
0079   0008           00125 RETURN
                      00126 
                      00127 
                      00128 
                      00129 ;----------------------- Sección de subrutinas secundarias --------------------
                      00130 ;{
007A                  00131 ESCRIBETITULO ; Escribiremos un mensaje inicial.
Warning[206]: Found call to macro in column 1. (lcdfc)
                      00132 lcdfc .1,.6
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .1==1
007A   3006               M         MOVLW .6
007B   00AD               M         MOVWF ubicacionlcdfcr
007C   03AD               M         DECF ubicacionlcdfcr,1
007D   3080               M         MOVlW 0X80
007E   072D               M         ADDWF ubicacionlcdfcr,0
007F   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==2
                          M         MOVLW .6
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XC0
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==3
                          M         MOVLW .6
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M         if .1==4
                          M         MOVLW .6
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
Warning[206]: Found call to macro in column 1. (escribir)
                      00133 escribir 'A'
0080   3041               M            movlw 'A'
0081   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00134 escribir 'C'
0082   3043               M            movlw 'C'
0083   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00135 escribir 'C'
0084   3043               M            movlw 'C'
0085   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00136 escribir 'E'
0086   3045               M            movlw 'E'
0087   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00137 escribir 'S'
0088   3053               M            movlw 'S'
0089   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00138 escribir 'O'
008A   304F               M            movlw 'O'
008B   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[203]: Found opcode in column 1. (RETURN)
008C   0008           00139 RETURN
                      00140 ;}
                      00141 ;{
008D                  00142 ESCRIBEPARTE2 ; Escribiremos un mensaje en la parte inferior
Warning[206]: Found call to macro in column 1. (lcdfc)
                      00143 lcdfc .2,.1
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .2==1
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X80
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==2
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008D   3001               M         MOVLW .1
008E   00AD               M         MOVWF ubicacionlcdfcr
008F   03AD               M         DECF ubicacionlcdfcr,1
0090   30C0               M         MOVlW 0XC0
0091   072D               M         ADDWF ubicacionlcdfcr,0
0092   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==3
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .2==4
                          M         MOVLW .1
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
Warning[206]: Found call to macro in column 1. (escribir)
                      00144 escribir 'C'
0093   3043               M            movlw 'C'
0094   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00145 escribir 'L'
0095   304C               M            movlw 'L'
0096   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00146 escribir 'A'
0097   3041               M            movlw 'A'
0098   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00147 escribir 'V'
0099   3056               M            movlw 'V'
009A   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00148 escribir 'E'
009B   3045               M            movlw 'E'
009C   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00149 escribir ':'
009D   303A               M            movlw ':'
009E   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00150 escribir ' '
009F   3020               M            movlw ' '
00A0   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[203]: Found opcode in column 1. (RETURN)
00A1   0008           00151 RETURN
                      00152 ;}
                      00153 ;{
00A2                  00154 ESCRIBEPARTE3 ; Escribiremos un mensaje en la parte inferior
Warning[206]: Found call to macro in column 1. (lcdfc)
                      00155 lcdfc .1,.5
                          M 
                          M         ;/// Para seleccionar la fila
                          M         if .1==1
00A2   3005               M         MOVLW .5
00A3   00AD               M         MOVWF ubicacionlcdfcr
00A4   03AD               M         DECF ubicacionlcdfcr,1
00A5   3080               M         MOVlW 0X80
00A6   072D               M         ADDWF ubicacionlcdfcr,0
00A7   2???               M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==2
                          M         MOVLW .5
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XC0
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==3
                          M         MOVLW .5
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0X94
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         if .1==4
                          M         MOVLW .5
                          M         MOVWF ubicacionlcdfcr
                          M         DECF ubicacionlcdfcr,1
                          M         MOVlW 0XD4
                          M         ADDWF ubicacionlcdfcr,0
                          M         call ESCRIBIRCOMANDO
                          M         endif
                          M         ;Para seleccionar la columna
                          M 
Warning[206]: Found call to macro in column 1. (escribir)
                      00156 escribir 'C'
00A8   3043               M            movlw 'C'
00A9   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00157 escribir 'O'
00AA   304F               M            movlw 'O'
00AB   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00158 escribir 'R'
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00AC   3052               M            movlw 'R'
00AD   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00159 escribir 'R'
00AE   3052               M            movlw 'R'
00AF   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00160 escribir 'E'
00B0   3045               M            movlw 'E'
00B1   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00161 escribir 'C'
00B2   3043               M            movlw 'C'
00B3   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00162 escribir 'T'
00B4   3054               M            movlw 'T'
00B5   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[206]: Found call to macro in column 1. (escribir)
                      00163 escribir 'O'
00B6   304F               M            movlw 'O'
00B7   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[203]: Found opcode in column 1. (RETURN)
00B8   0008           00164 RETURN
                      00165 ;}
                      00166 
                      00167 ;------------------------------------------------------------------------------
                      00168 
                      00169 ;INCLUDE <matematica.asm> ;Incluimos la librería de matemática v 1.1
Warning[205]: Found directive in column 1. (INCLUDE)
                      00170 INCLUDE <teclado4x4.asm> ;Incluimos la librería de teclado matricial 4x4 v 1.0
                      00001 ; ....................www.rodrigocarita.com................................
                      00002 ; Librería para teclado matricial 4x4
                      00003 ;Versión : 1.0
                      00004 ;..:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
                            ::::::::
                      00005 ;Atencion: Esta librería funciona con la macro en Versión 1.2 y superiores.
                      00006 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
                            ::::::
                      00007 ;   | 1 | 2 | 3 | A |   --->PORTB,0
                      00008 ;   | 4 | 5 | 6 | B |   ---> PORTB,1
                      00009 ;   | 7 | 8 | 9 | C |    --->PORTB,2
                      00010 ;   | * | 0 | # | D |   ---> PORTB,3
                      00011 ;      |    |    |    |
                      00012 ;    RB4 RB5 RB6 RB7
                      00013 ;::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
                      00014 ;Modo de conexión es sencilla, con el teclado mirándonos, los pines se conectan de modo
                      00015 ;                                    RB0,RB1,RB2,RB3,...,RB7,
                      00016 ;-------------------------------------------------------------------------------------------------------
                            ----------------------
                      00017 
Warning[205]: Found directive in column 1. (CBLOCK)
                      00018 CBLOCK               ;Bloque de memorias para la subrutina
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000024            00019 tekl4pul5        ;Registro donde se almacenará el valor de la tecla pulsada
  00000025            00020 c0mpparadD0r ;Registro que será el comparador para el escaner de teclado
  00000026            00021 Sit3cl4pus     ;Registro de bucle para pausar o leer de corrido
  00000027            00022 Hhayrt3cla     ;Registro que permite saber si hay una tecla pulsada
Warning[205]: Found directive in column 1. (ENDC)
                      00023 ENDC            ;Fin bloques de memorias        
                      00024 
00B9                  00025 IN1ci0t3cla4do                  ; Subrutina de configuración de Teclado. Activa las resistencias PULL-UP
Warning[206]: Found call to macro in column 1. (banco)
                      00026 banco 1                                 ;Vamos al banco 1
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 1==0
                          M BCF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==1
                          M ;banco 1
Warning[203]: Found opcode in column 1. (BSF)
00B9   1683               M BSF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
00BA   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[203]: Found opcode in column 1. (MOVLW)
00BB   30F0           00027 MOVLW b'11110000'       ; Configuramos las columnas como salida y las filas como entrada
Warning[203]: Found opcode in column 1. (MOVWF)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BC   0086           00028 MOVWF TRISB                     ;del puerto B.
Warning[203]: Found opcode in column 1. (BCF)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BD   1381           00029 BCF OPTION_REG,7                ;Activa las resistencias tipo PULL-UP del pic
Warning[206]: Found call to macro in column 1. (banco)
                      00030 banco 0                                 ;Regresamos al Banco 0
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M if 0==0
Warning[203]: Found opcode in column 1. (BCF)
00BE   1283               M BCF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
00BF   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==1
                          M ;banco 1
                          M BSF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[203]: Found opcode in column 1. (CLRF)
00C0   01A4           00031 CLRF tekl4pul5          ;Limpiamos memorias de teclapulsada
Warning[203]: Found opcode in column 1. (CLRF)
00C1   01A6           00032 CLRF Sit3cl4pus         ;Limpiamos permisos para bucles
Warning[203]: Found opcode in column 1. (RETURN)
00C2   0008           00033 RETURN                          ;Salimos de la subrutina de configuración
                      00034 
00C3                  00035 Tttest3aTecld0o                                                 ;título de subrutina para escaner de tec
                            lado    
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00036 cargarvalor .0,Hhayrt3cla                               ;Limpiamos el valor de comprobación si hubo una 
                            tecla pulsada
00C3   3000               M         MOVLW .0
00C4   00A7               M         MOVWF Hhayrt3cla
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00037 cargarvalor b'11111110',PORTB                   ;Cargamos el primer valor para escanear la primera fila
00C5   30FE               M         MOVLW b'11111110'
00C6   0086               M         MOVWF PORTB
Warning[203]: Found opcode in column 1. (nop)
00C7   0000           00038 nop                                                                             ;Tiempo paranóico
Warning[206]: Found call to macro in column 1. (copiarregistro)
                      00039 copiarregistro PORTB,c0mpparadD0r               ;Leemos el puerto B para ver si hay un botón pulsado
00C8   0806               M         MOVF PORTB,0
00C9   00A5               M         MOVWF c0mpparadD0r
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[206]: Found call to macro in column 1. (csi)
                      00040 csi c0mpparadD0r,b'11101110',BoTt0Nn1   ;Iniciamos el Escaneo, Se pulsó la primera columná?     
00CA   30EE               M                 movlw   b'11101110'
00CB   0225               M                  subwf  c0mpparadD0r,0
00CC   1903               M                  btfsc  STATUS,Z
00CD   2???               M                  goto   BoTt0Nn1
Warning[206]: Found call to macro in column 1. (csi)
                      00041 csi c0mpparadD0r,b'11011110',BoTt0Nn2   ;Se pulsó la segunda columna?   
00CE   30DE               M                 movlw   b'11011110'
00CF   0225               M                  subwf  c0mpparadD0r,0
00D0   1903               M                  btfsc  STATUS,Z
00D1   2???               M                  goto   BoTt0Nn2
Warning[206]: Found call to macro in column 1. (csi)
                      00042 csi c0mpparadD0r,b'10111110',BoTt0Nn3   ;Se pulsó la tercera columna?
00D2   30BE               M                 movlw   b'10111110'
00D3   0225               M                  subwf  c0mpparadD0r,0
00D4   1903               M                  btfsc  STATUS,Z
00D5   2???               M                  goto   BoTt0Nn3
Warning[206]: Found call to macro in column 1. (csi)
                      00043 csi c0mpparadD0r,b'01111110',BoTt0NnA   ;Se pulsó la cuarta columna?
00D6   307E               M                 movlw   b'01111110'
00D7   0225               M                  subwf  c0mpparadD0r,0
00D8   1903               M                  btfsc  STATUS,Z
00D9   2???               M                  goto   BoTt0NnA
                      00044 
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00045 cargarvalor b'11111101',PORTB                   ;Cargamos el segundo valor para escanear la segunda fila
00DA   30FD               M         MOVLW b'11111101'
00DB   0086               M         MOVWF PORTB
Warning[203]: Found opcode in column 1. (nop)
00DC   0000           00046 nop                                                                             ;Tiempo paranóico
Warning[206]: Found call to macro in column 1. (copiarregistro)
                      00047 copiarregistro PORTB,c0mpparadD0r                ;Leemos el puerto B para ver si hay un botón pulsado
00DD   0806               M         MOVF PORTB,0
00DE   00A5               M         MOVWF c0mpparadD0r
Warning[206]: Found call to macro in column 1. (csi)
                      00048 csi c0mpparadD0r,b'11101101',BoTt0Nn4         ;Iniciamos el Escaneo, Se pulsó la primera columná?       
00DF   30ED               M                 movlw   b'11101101'
00E0   0225               M                  subwf  c0mpparadD0r,0
00E1   1903               M                  btfsc  STATUS,Z
00E2   2???               M                  goto   BoTt0Nn4
Warning[206]: Found call to macro in column 1. (csi)
                      00049 csi c0mpparadD0r,b'11011101',BoTt0Nn5         ;Se pulsó la segunda columna?     
00E3   30DD               M                 movlw   b'11011101'
00E4   0225               M                  subwf  c0mpparadD0r,0
00E5   1903               M                  btfsc  STATUS,Z
00E6   2???               M                  goto   BoTt0Nn5
Warning[206]: Found call to macro in column 1. (csi)
                      00050 csi c0mpparadD0r,b'10111101',BoTt0Nn6         ;Se pulsó la tercera columna?
00E7   30BD               M                 movlw   b'10111101'
00E8   0225               M                  subwf  c0mpparadD0r,0
00E9   1903               M                  btfsc  STATUS,Z
00EA   2???               M                  goto   BoTt0Nn6
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[206]: Found call to macro in column 1. (csi)
                      00051 csi c0mpparadD0r,b'01111101',BoTt0NnB         ;Se pulsó la cuarta columna?
00EB   307D               M                 movlw   b'01111101'
00EC   0225               M                  subwf  c0mpparadD0r,0
00ED   1903               M                  btfsc  STATUS,Z
00EE   2???               M                  goto   BoTt0NnB
                      00052 
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00053 cargarvalor b'11111011',PORTB                   ;Cargamos el tercer valor para escanear la tercera fila 
00EF   30FB               M         MOVLW b'11111011'
00F0   0086               M         MOVWF PORTB
Warning[203]: Found opcode in column 1. (nop)
00F1   0000           00054 nop                                                                                    ;Tiempo paranóico
                             
Warning[206]: Found call to macro in column 1. (copiarregistro)
                      00055 copiarregistro PORTB,c0mpparadD0r                  ;Leemos el puerto B para ver si hay un botón pulsado
00F2   0806               M         MOVF PORTB,0
00F3   00A5               M         MOVWF c0mpparadD0r
Warning[206]: Found call to macro in column 1. (csi)
                      00056 csi c0mpparadD0r,b'11101011',BoTt0Nn7         ;Iniciamos el Escaneo, Se pulsó la primera columná?       
00F4   30EB               M                 movlw   b'11101011'
00F5   0225               M                  subwf  c0mpparadD0r,0
00F6   1903               M                  btfsc  STATUS,Z
00F7   2???               M                  goto   BoTt0Nn7
Warning[206]: Found call to macro in column 1. (csi)
                      00057 csi c0mpparadD0r,b'11011011',BoTt0Nn8         ;Se pulsó la segunda columna?     
00F8   30DB               M                 movlw   b'11011011'
00F9   0225               M                  subwf  c0mpparadD0r,0
00FA   1903               M                  btfsc  STATUS,Z
00FB   2???               M                  goto   BoTt0Nn8
Warning[206]: Found call to macro in column 1. (csi)
                      00058 csi c0mpparadD0r,b'10111011',BoTt0Nn9         ;Se pulsó la tercera columna?
00FC   30BB               M                 movlw   b'10111011'
00FD   0225               M                  subwf  c0mpparadD0r,0
00FE   1903               M                  btfsc  STATUS,Z
00FF   2???               M                  goto   BoTt0Nn9
Warning[206]: Found call to macro in column 1. (csi)
                      00059 csi c0mpparadD0r,b'01111011',BoTt0NnC         ;Se pulsó la cuarta columna?
0100   307B               M                 movlw   b'01111011'
0101   0225               M                  subwf  c0mpparadD0r,0
0102   1903               M                  btfsc  STATUS,Z
0103   2???               M                  goto   BoTt0NnC
                      00060 
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00061 cargarvalor b'11110111',PORTB                   ;Cargamos el cuarto valor para escanear la cuarta fila  
0104   30F7               M         MOVLW b'11110111'
0105   0086               M         MOVWF PORTB
Warning[203]: Found opcode in column 1. (nop)
0106   0000           00062 nop                                                                                    ;Tiempo paranóico
                             
Warning[206]: Found call to macro in column 1. (copiarregistro)
                      00063 copiarregistro PORTB,c0mpparadD0r                  ;Leemos el puerto B para ver si hay un botón pulsado
0107   0806               M         MOVF PORTB,0
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0108   00A5               M         MOVWF c0mpparadD0r
Warning[206]: Found call to macro in column 1. (csi)
                      00064 csi c0mpparadD0r,b'11100111',BoTt0NnAST     ;Iniciamos el Escaneo, Se pulsó la primera columná? 
0109   30E7               M                 movlw   b'11100111'
010A   0225               M                  subwf  c0mpparadD0r,0
010B   1903               M                  btfsc  STATUS,Z
010C   2???               M                  goto   BoTt0NnAST
Warning[206]: Found call to macro in column 1. (csi)
                      00065 csi c0mpparadD0r,b'11010111',BoTt0Nn0         ;Se pulsó la segunda columna?     
010D   30D7               M                 movlw   b'11010111'
010E   0225               M                  subwf  c0mpparadD0r,0
010F   1903               M                  btfsc  STATUS,Z
0110   2???               M                  goto   BoTt0Nn0
Warning[206]: Found call to macro in column 1. (csi)
                      00066 csi c0mpparadD0r,b'10110111',BoTt0NnMICH   ;Se pulsó la tercera columna? 
0111   30B7               M                 movlw   b'10110111'
0112   0225               M                  subwf  c0mpparadD0r,0
0113   1903               M                  btfsc  STATUS,Z
0114   2???               M                  goto   BoTt0NnMICH
Warning[206]: Found call to macro in column 1. (csi)
                      00067 csi c0mpparadD0r,b'01110111',BoTt0NnD         ;Se pulsó la cuarta columna?
0115   3077               M                 movlw   b'01110111'
0116   0225               M                  subwf  c0mpparadD0r,0
0117   1903               M                  btfsc  STATUS,Z
0118   2???               M                  goto   BoTt0NnD
Warning[206]: Found call to macro in column 1. (csi)
                      00068 csi c0mpparadD0r,b'11110111',SinTecl4    ; NO SE PULSÓ NADA??   
0119   30F7               M                 movlw   b'11110111'
011A   0225               M                  subwf  c0mpparadD0r,0
011B   1903               M                  btfsc  STATUS,Z
011C   2???               M                  goto   SinTecl4
                      00069 
011D                  00070 SinTecl4                                        ;Subrutina para cuando no haya alguna tecla pulsada.    
                                    
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00071 cargarvalor .1,Hhayrt3cla       ; Carga el valor de 1 en el registro Hhayrt3cla 
011D   3001               M         MOVLW .1
011E   00A7               M         MOVWF Hhayrt3cla
Warning[203]: Found opcode in column 1. (BTFSS)
011F   1C26           00072 BTFSS Sit3cl4pus,0                      ;Esta en el modo de pausa?
Warning[203]: Found opcode in column 1. (RETURN)
0120   0008           00073 RETURN                                          ;Caso falso: Sale de la subrutina continuando con el pro
                            grama principal
Warning[203]: Found opcode in column 1. (GOTO)
0121   2???           00074 GOTO Tttest3aTecld0o                    ;Caso verdadero: Continua testeando el teclado hasta que una tec
                            la se pulse
                      00075 
0122                  00076 BoTt0Nn0                                        ;Subrutina para cuando se presione el botón 0
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00077 cargarvalor .0,tekl4pul5                ;Carga el valor de "0" en el registro de respuesta tekl4pul5 
0122   3000               M         MOVLW .0
0123   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0124   0008           00078 RETURN                                          ;Sale de la subrutina de teclado
                      00079 
0125                  00080 BoTt0Nn1                                        ;Subrutina para cuando se presione el botón 1
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00081 cargarvalor .1,tekl4pul5           ;Carga el valor de "1" en el registro de respuesta tekl4pul5 
0125   3001               M         MOVLW .1
0126   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0127   0008           00082 RETURN                                                  ;Sale de la subrutina de teclado
                      00083 
0128                  00084 BoTt0Nn2                                        ;Subrutina para cuando se presione el botón 2
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00085 cargarvalor .2,tekl4pul5           ;Carga el valor de "2" en el registro de respuesta tekl4pul5 
0128   3002               M         MOVLW .2
0129   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
012A   0008           00086 RETURN                                                  ;Sale de la subrutina de teclado
                      00087 
012B                  00088 BoTt0Nn3                                        ;Subrutina para cuando se presione el botón 3
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00089 cargarvalor .3,tekl4pul5           ;Carga el valor de "3" en el registro de respuesta tekl4pul5 
012B   3003               M         MOVLW .3
012C   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
012D   0008           00090 RETURN                                                  ;Sale de la subrutina de teclado
                      00091 
012E                  00092 BoTt0Nn4                                        ;Subrutina para cuando se presione el botón 4
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00093 cargarvalor .4,tekl4pul5           ;Carga el valor de "4" en el registro de respuesta tekl4pul5 
012E   3004               M         MOVLW .4
012F   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0130   0008           00094 RETURN                                                  ;Sale de la subrutina de teclado
                      00095 
0131                  00096 BoTt0Nn5                                        ;Subrutina para cuando se presione el botón 5
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00097 cargarvalor .5,tekl4pul5           ;Carga el valor de "5" en el registro de respuesta tekl4pul5 
0131   3005               M         MOVLW .5
0132   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0133   0008           00098 RETURN                                                  ;Sale de la subrutina de teclado
                      00099 
0134                  00100 BoTt0Nn6                                        ;Subrutina para cuando se presione el botón 6
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00101 cargarvalor .6,tekl4pul5           ;Carga el valor de "6" en el registro de respuesta tekl4pul5 
0134   3006               M         MOVLW .6
0135   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0136   0008           00102 RETURN                                                  ;Sale de la subrutina de teclado
                      00103 
0137                  00104 BoTt0Nn7                                        ;Subrutina para cuando se presione el botón 7
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00105 cargarvalor .7,tekl4pul5           ;Carga el valor de "7" en el registro de respuesta tekl4pul5 
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0137   3007               M         MOVLW .7
0138   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0139   0008           00106 RETURN                                                  ;Sale de la subrutina de teclado
                      00107 
013A                  00108 BoTt0Nn8                                        ;Subrutina para cuando se presione el botón 8
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00109 cargarvalor .8,tekl4pul5           ;Carga el valor de "8" en el registro de respuesta tekl4pul5 
013A   3008               M         MOVLW .8
013B   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
013C   0008           00110 RETURN                                                  ;Sale de la subrutina de teclado
                      00111 
013D                  00112 BoTt0Nn9                                        ;Subrutina para cuando se presione el botón 9   
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00113 cargarvalor .9,tekl4pul5           ;Carga el valor de "9" en el registro de respuesta tekl4pul5 
013D   3009               M         MOVLW .9
013E   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
013F   0008           00114 RETURN                                                  ;Sale de la subrutina de teclado
                      00115 
0140                  00116 BoTt0NnA                                        ;Subrutina para cuando se presione el botón A
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00117 cargarvalor .10,tekl4pul5        ;Carga el valor de "10" en el registro de respuesta tekl4pul5
0140   300A               M         MOVLW .10
0141   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0142   0008           00118 RETURN                                                  ;Sale de la subrutina de teclado
                      00119 
0143                  00120 BoTt0NnB                                        ;Subrutina para cuando se presione el botón B
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00121 cargarvalor .11,tekl4pul5        ;Carga el valor de "11" en el registro de respuesta tekl4pul5
0143   300B               M         MOVLW .11
0144   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0145   0008           00122 RETURN                                                  ;Sale de la subrutina de teclado
                      00123 
0146                  00124 BoTt0NnC                                        ;Subrutina para cuando se presione el botón C
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00125 cargarvalor .12,tekl4pul5        ;Carga el valor de "12" en el registro de respuesta tekl4pul5
0146   300C               M         MOVLW .12
0147   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0148   0008           00126 RETURN                                                  ;Sale de la subrutina de teclado
                      00127 
0149                  00128 BoTt0NnD                                        ;Subrutina para cuando se presione el botón D
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00129 cargarvalor .13,tekl4pul5        ;Carga el valor de "13" en el registro de respuesta tekl4pul5
0149   300D               M         MOVLW .13
014A   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
014B   0008           00130 RETURN                                                  ;Sale de la subrutina de teclado
                      00131 
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

014C                  00132 BoTt0NnAST                                      ;Subrutina para cuando se presione el botón *   
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00133 cargarvalor .14,tekl4pul5        ;Carga el valor de "14" en el registro de respuesta tekl4pul5
014C   300E               M         MOVLW .14
014D   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
014E   0008           00134 RETURN                                                  ;Sale de la subrutina de teclado
                      00135 
014F                  00136 BoTt0NnMICH                                     ;Subrutina para cuando se presione el botón #
Warning[206]: Found call to macro in column 1. (cargarvalor)
                      00137 cargarvalor .15,tekl4pul5        ;Carga el valor de "15" en el registro de respuesta tekl4pul5
014F   300F               M         MOVLW .15
0150   00A4               M         MOVWF tekl4pul5
Warning[203]: Found opcode in column 1. (RETURN)
0151   0008           00138 RETURN                                                  ;Sale de la subrutina de teclado
                      00139 
                      00140 ; Revisa las últimas actualizaciones de la librería en:
                      00141 ;......................................................................... rodrigocarita.com ...........
                            .......................................................................................
                      00142 
Warning[205]: Found directive in column 1. (INCLUDE)
                      00171 INCLUDE <lcd16x2.asm>   ;Incluimos la librería de lcd v 1.2
                      00001 ; :::::::::::::::::::::: www.rodrigocarita.com ::::::::::::::::::::::::::::::
                      00002 ; Librería: lcd16x2.asm
                      00003 ; Versión : 1.2
                      00004 ; ---------------------------------------------------------------------------
                      00005 ; Esta archivo requiere de las librerías RETARDOS.ASM y conversor.ASM
                      00006 
Warning[205]: Found directive in column 1. (cblock)
                      00007 cblock 
  00000028            00008         NumCadena               ;número de la cadena 
  00000029            00009         indice
  0000002A            00010         memocaracter            
  0000002B            00011         memoriaw
  0000002C            00012         caractertemp
  0000002D            00013          ubicacionlcdfcr
  0000002E            00014         ubicacionlcdccr
  0000002F            00015         Varregcomp
Warning[205]: Found directive in column 1. (ENDC)
                      00016 endc
                      00017 
  00000008            00018 DATOS EQU PORTD                 ;lineas de datos = portD
  00000008            00019 pinlcd EQU PORTD                ;lineas de control = portD
                      00020 
  00000001            00021 RS EQU 1 ;linea de control RS = bit1
  00000002            00022 RW EQU 2 ;linea de control RW = bit2
  00000003            00023 E EQU 3  ;linea de control E = bit3
                      00024 
  0000000F            00025 on_display_cursor_blink EQU     0FH     ;Activa el display, el cursor y hace parpadear el cursor
  0000000C            00026 solo_display            EQU     0CH     ; Apaga el cursor y su parpadeo Pertenece al comando Display ON/
                            OFF
  00000001            00027 limpiar_lcd                     EQU     01H     ; limpia los caracteres de la pantalla
  00000008            00028 apagar_el_display       EQU     08H             ; apaga la pantalla
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000000C0            00029 salto_enter                     EQU     0C0H    ; Se dirije a la segunda línea
  00000002            00030 home_inicio                     EQU     02H     ; Vuelve al inicio
                      00031 
  00000010            00032 mover_cursor_izquierda EQU 10H  ; Mueve el cursor a la izquierda
  00000014            00033 mover_cursor_derecha EQU 14H    ; Mueve el cursor a la derecha
                      00034 
  00000018            00035 mover_pantalla_izquierda        EQU     18H     ; Mueve toda al pantalla a la izquierda
  0000001C            00036 mover_pantalla_derecha          EQU     1CH     ; Mueve toda la pantalla a la derecha
                      00037 
  00000000            00038 off                                     EQU  0
  00000001            00039 on                                      EQU  1
                      00040 
                      00041 ;//////////////////////////////////////////////////////////////////
                      00042 ; Como la conexión al lcd lo estamos desarrollando mediante 4 hilos,
                      00043 ;Para enviar datos de 8 bits se va a realizar por partes.
                      00044 ;Esta subrutina se encarga de enmascarar el byte para en primer lugar
                      00045 ;A los bits de mayor peso y luego de un impulso en el pin de Enable
                      00046 ;Enviará el segundo.
0152                  00047 ESCRIBIRCOMANDO                            ;Subrutina para separar en 2 grupos un byte y enviarlos al co
                            ntrolador por partes.
0152   00AA           00048         movwf   memocaracter       ;Desde la macro llegamos con un valor en w, ahora lo guardaremos el r
                            egistro memocaracter.
0153   2???           00049         call    COMPROBARSIOCUPADO ;Llamamos a la subrutina que comprueba que el controlador está desocu
                            pado.
0154   082A           00050         movf    memocaracter,w     ;Extraemos en W el valor que guardamos en el registro memocaracter. 
0155   39F0           00051         andlw   b'11110000'        ;El código de enmascaramiento que nos permitirá quedarnos con los 4bi
                            ts MSB.
0156   0088           00052         movwf   DATOS              ;Guardamos el valor del enmasacaramiento en un registro llamado DATOS
                            .
0157   1108           00053         bcf     pinlcd,RW          ;Para que el LCD reciba comandos RW se encuentre en 0.
0158   1088           00054         bcf     pinlcd,RS          ;Otro pin que debemos poner a 0 para que el modulo trabaje en modo co
                            mando.
0159   0000           00055         nop                                                ;Esperamos un pequeño tiempo 0.2uS.
015A   1588           00056         bsf     pinlcd,E           ;Realizamos el impulso en el pin de Enable para realizar la transfere
                            ncia del Dato.
015B   0000           00057         nop                                                ; Ancho del impulso 0.2uS.                   
                                            
015C   1188           00058         bcf     pinlcd,E           ; Fin del impulso. 
015D   0E2A           00059         swapf   memocaracter,w     ;Ahora nos queda extraer los 4LSB, los intercambiamos con los de MSB 
                            y almacenamos en W.
015E   39F0           00060         andlw   b'11110000'         ;Volvemos a realizar el enmascaramiento de los 4MSB despues del inte
                            rcambio con swapf.
015F   0088           00061         movwf   DATOS              ;El resultado lo guardamos en el registro DATOS.
0160   0000           00062         nop                                                ; Esperamos un pequeño tiempo 0.2uS.
0161   1588           00063         bsf     pinlcd,E           ;Realizamos el impulso en el pin de Enable para enviar la segunda par
                            te del comando.
0162   0000           00064         nop                                                ; Ancho del impulso 0.2uS.
0163   1188           00065         bcf     pinlcd,E           ;Fin del impulso.
Warning[203]: Found opcode in column 1. (RETURN)
0164   0008           00066 RETURN                                     ; Regresamos a donde nos han llamado.
                      00067 
0165                  00068 ESCRIBIRCARACTER                                ;Subrutina para separar en 2 grupos un byte y enviarlos 
                            al controlador por partes.
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0165   00AB           00069         movwf   memoriaw                        ;Posiblemente se llegue a la subrutina con un valor en W
                            , vamos a guardarlo y devolverlo al final.
0166   00AA           00070         movwf   memocaracter        ;Desde la macro llegamos con un valor en w, ahora lo guardaremos el 
                            registro memocaracter.
0167   2???           00071         call    COMPROBARSIOCUPADO  ;Llamamos a la subrutina que comprueba que el controlador está desoc
                            upado.
0168   082A           00072         movf    memocaracter,w      ;Extraemos en W el valor que guardamos en el registro memocaracter. 
                               
0169   39F0           00073         andlw   b'11110000'         ;El código de enmascaramiento que nos permitirá quedarnos con los 4b
                            its MSB.
016A   0088           00074         movwf   DATOS                   ;Guardamos el valor del enmasacaramiento en un registro llamado 
                            DATOS.
016B   1108           00075         bcf     pinlcd,RW               ;Para que el LCD reciba datos RW se encuentre en 0.
016C   1488           00076         bsf     pinlcd,RS               ;Pin que debemos poner a 1 para que el modulo trabaje en modo vi
                            sualización. 
016D   0000           00077         nop                                                     ;Esperamos un pequeño tiempo 0.2uS.
016E   1588           00078         bsf     pinlcd,E                ;Realizamos el impulso en el pin de Enable para realizar la tran
                            sferencia del Dato.
016F   0000           00079         nop                                                     ;Ancho del impulso 0.2uS.
0170   1188           00080         bcf     pinlcd,E                        ;Fin del impulso.       
0171   0E2A           00081         swapf   memocaracter,w          ;Ahora nos queda extraer los 4LSB, los intercambiamos con los de
                             MSB y almacenamos en W.
0172   39F0           00082         andlw   b'11110000'             ;Volvemos a realizar el enmascaramiento de los 4MSB despues del 
                            intercambio con swapf.
0173   0088           00083         movwf   DATOS                   ;El resultado lo guardamos en el registro DATOS.
0174   1108           00084         bcf     pinlcd,RW               ;Aseguramos que el pin RW se encuenre en 0 para empezar a recibi
                            r datos.
0175   1488           00085         bsf     pinlcd,RS               ;Aseguramos que el Pin RS se encuentre en modo visualización. (r
                            ecibe caracteres).
0176   0000           00086         nop                                                     ;Esperamos un pequeño tiempo 0.2uS.
0177   1588           00087         bsf     pinlcd,E                ;Realizamos el impulso en el pin de Enable para realizar la tran
                            sferencia del Dato.
0178   0000           00088         nop                                                     ;Ancho del impulso 0.2uS.
0179   1188           00089         bcf     pinlcd,E                        ;Fin del impulso
017A   082B           00090         movf    memoriaw,W                      ;Finalizada la subrutina devolvemos el valor de W para q
                            ue no modifique el proceso
Warning[203]: Found opcode in column 1. (RETURN)
017B   0008           00091 RETURN                                          ;Fin de la subrutina
                      00092         
017C                  00093 COMPROBARSIOCUPADO                              ;Subrutina Testeará la bandera de Busy para saber si el 
                            controlador del módulo está ocupado.
                      00094         banco   1                                       ;Vamos al banco 1 para cambiar los pines D4 a D7
                             como entrada, por ahi recibiremos el dato
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 1==0
                          M BCF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==1
                          M ;banco 1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[203]: Found opcode in column 1. (BSF)
017C   1683               M BSF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
017D   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
017E   30F0           00095         movlw   b'11110000'                     ;Pines D4 a D7 como entrada
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017F   0088           00096         movwf   TRISD                           ;Conectados al puerto D
                      00097         banco   0                                       ;Volvemos al banco 0 para realizar el testeo
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 0==0
Warning[203]: Found opcode in column 1. (BCF)
0180   1283               M BCF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
0181   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==1
                          M ;banco 1
                          M BSF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==3
                          M ;banco 3
                          M BSF STATUS, RP0
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M BSF STATUS, RP1
                          M endif
                          M 
0182   1088           00098         bcf     pinlcd,RS               ;Configuramos el controlador en modo Comando
0183   1508           00099         bsf     pinlcd,RW               ;Configuramos el LCD para que nos envie datos.
0184   0000           00100         nop                                                     ;Esperamos un pequeño tiempo 0.2uS
0185   1588           00101         bsf     pinlcd,E                ;Activamos el pin de Enable para que empiece la transferencia y 
                            el módulo nos responda.
0186   0000           00102         nop                                                     ;Esperamos un prqueño tiempo de 0.2uS
0187   0808           00103         movf    DATOS,W                 ;Extrae el valor del registro DATOS (4msb) y lo guarda en W está
                             es la primera respuesta
0188   1188           00104         bcf     pinlcd,E                ;Apagamos el pin de Enable para leer los 4lsb restantes.
0189   39F0           00105         andlw   0F0h                    ;La respuesta anterior la enmascaramos
018A   00AC           00106         movwf   caractertemp            ;Almacenamos el caracter temporalmente
018B   0000           00107         nop                                                     ;Esperamos un pequeño tiempo            
                                                    
018C   1588           00108         bsf     pinlcd,E                        ;Activamos el pin de Enable para que comience la transfe
                            rencia.
018D   0000           00109         nop                                                     ;Esperamos otro pequeño tiempo
018E   0E08           00110         swapf   DATOS,w                 ;Leemos la respuesta y lo intercambiamos con los 4msb para guard
                            arlo en W
018F   1188           00111         bcf     pinlcd,E                ;Apagamos la transferencia.
0190   390F           00112         andlw   00Fh                    ;Enmascaramos la segunda respuesta
0191   04AC           00113         iorwf   caractertemp,1      ;Combina nibbles Juntamos la primera con la segunda respuesta para f
                            ormar la respuesta gral
0192   1BAC           00114         btfsc   caractertemp,7      ;Comprobamos el pin 7 de la respuesta, esta es la bandera de busy, s
                            i se encuentra en 1=ocupado
0193   2???           00115         goto    COMPROBARSIOCUPADO  ;Si la respuesta es ocupado repetiremos todo el proceso denuevo
0194   1108           00116         bcf     pinlcd,RW               ;Si la respuesta es desocupado Continuamos, en este caso apagamo
                            s el bit de intercambio de datos
                      00117         banco   1                                       ;Vamos al banco 1 para dejar las cosas como esta
                            ban antes
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 1==0
                          M BCF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==1
                          M ;banco 1
Warning[203]: Found opcode in column 1. (BSF)
0195   1683               M BSF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
0196   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==2
                          M ;banco 2
                          M BCF STATUS, RP0
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
0197   3000           00118         movlw   0x00                            ;Ahora todos los pines como Salida
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0198   0088           00119         movwf   TRISD                           ;Del puerto D
                      00120         banco   0                                       ;Vamos al banco 0
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 0==0
Warning[203]: Found opcode in column 1. (BCF)
0199   1283               M BCF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
019A   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==1
                          M ;banco 1
                          M BSF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[203]: Found opcode in column 1. (RETURN)
019B   0008           00121 RETURN                                          ;Salimos de la subrutina
                      00122 
019C                  00123 Inicio_lcd                                              ; Esta es la subrutina de secuencia para iniciar
                             el LCD
                      00124         banco 0                                     ; Nos dirijimos al banco 0 para manipular pines
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M if 0==0
Warning[203]: Found opcode in column 1. (BCF)
019C   1283               M BCF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
019D   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==1
                          M ;banco 1
                          M BSF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
019E   1188           00125         bcf     pinlcd,E                                ; Apagamos el pin de E
019F   1108           00126         bcf     pinlcd,RW                               ; Apagamos el pin de RW
01A0   1088           00127         bcf     pinlcd,RS                               ; Apagamos el pin de RS
01A1   300F           00128         movlw   0x0F                            ; Encendemos los pines del LCD
01A2   0088           00129         movwf   DATOS                           ; En el puerto D
                      00130 
                      00131         banco 1                                     ; Vamos al banco 1
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 1==0
                          M BCF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==1
                          M ;banco 1
Warning[203]: Found opcode in column 1. (BSF)
01A3   1683               M BSF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
01A4   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (if)
                          M if 1==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 1==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
01A5   300F           00132         movlw B'00001111'       ;Declaramos Todos los pines como salida 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A6   0088           00133         movwf TRISD                             ;Del puerto D
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A7   1188           00134         bcf     TRISD,E                                 ;Aseguramos que el Pin E sea salida     
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A8   1108           00135         bcf     TRISD,RW                                ;Aseguramos que el pin RW sea salida
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A9   1088           00136         bcf     TRISD,RS                                ;Aseguramos que el pin RS sea salida
                      00137         banco   0                                       ;Regresamos al banco 0
                          M ;banco 0
Warning[205]: Found directive in column 1. (if)
                          M if 0==0
Warning[203]: Found opcode in column 1. (BCF)
01AA   1283               M BCF STATUS, RP0
Warning[203]: Found opcode in column 1. (BCF)
01AB   1303               M BCF STATUS, RP1
Warning[205]: Found directive in column 1. (endif)
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==1
                          M ;banco 1
                          M BSF STATUS, RP0
                          M BCF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==2
                          M ;banco 2
                          M BCF STATUS, RP0
                          M BSF STATUS, RP1
                          M endif
                          M 
Warning[205]: Found directive in column 1. (if)
                          M if 0==3
                          M ;banco 3
                          M BSF STATUS, RP0
                          M BSF STATUS, RP1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M endif
                          M 
                      00138 
                      00139 ; ///////////Comienza la secuencia de inicialización de la pantalla LCD//////////////////////
                      00140         milisegundo .20                         ;Despues de encendido tengo que esperar un tiempo mayor 
                            a 15ms
01AC   3014               M                          movlw .20
01AD   2???               M                          call  milisegundos
01AE   3030           00141         movlw   B'00110000'             ;Primer valor pedido por el fabricante
01AF   0088           00142         movwf   DATOS                           ;Lo escribimos en el Puerto D
01B0   0000           00143         nop                                                     ;Esperamos un pequeño tiempo
01B1   1588           00144         bsf     pinlcd,E                ;Enviamos un impulso al pin de Enable para enviar el dato
01B2   0000           00145         nop                                                     ;Ancho del impulso 0,2 uS
01B3   1188           00146         bcf     pinlcd,E                        ;Fin del impulso        
                      00147         milisegundo .10                         ;Antes de pasar al siguiente paso debo esperar más de 5m
                            s
01B4   300A               M                          movlw .10
01B5   2???               M                          call  milisegundos
01B6   3030           00148         movlw   B'00110000'             ;Segundo valor pedido por el fabricante
01B7   0088           00149         movwf   DATOS                   ;Lo escribimos en el Puerto D
01B8   0000           00150         nop                                                     ;Esperamos un pequeño tiempo
01B9   1588           00151         bsf     pinlcd,E                ;Enviamos un impulso al pin de Enable para enviar el dato
01BA   0000           00152         nop                                                     ;Ancho del impulso 0,2 uS
01BB   1188           00153         bcf     pinlcd,E                        ;Fin del impulso        
01BC   3030           00154         movlw   B'00110000'             ;Tercer valor pedido por el fabricante
01BD   0088           00155         movwf   DATOS                   ;Lo escribimos en el Puerto D
01BE   0000           00156         nop                                                     ;Esperamos un pequeño tiempo
01BF   1588           00157         bsf     pinlcd,E                ;Enviamos un impulso al pin de Enable para enviar el dato
01C0   0000           00158         nop                                                     ;Ancho del impulso 0,2 uS
01C1   1188           00159         bcf     pinlcd,E                        ;Fin del impulso
                      00160         milisegundo .2                          ;Antes de pasar al siguiente paso debo esperar más de 10
                            0uS
01C2   3002               M                          movlw .2
01C3   2???               M                          call  milisegundos
01C4   3020           00161         movlw   B'00100000'                     ;Cargamos comando de configuración de comunicación de 4b
                            its
01C5   0088           00162         movwf   DATOS                           ;Escribimos el comando en el puerto D
01C6   0000           00163         nop                                                     ;Esperamos un tiempo antes de realizar l
                            a transferencia
01C7   1588           00164         bsf     pinlcd,E                ;Enviamos un impulso al pin de Enable para enviar el dato
01C8   0000           00165         nop                                                     ;Ancho del impulso 0,2 uS
01C9   1188           00166         bcf     pinlcd,E                        ;Fin del impulso
                      00167 
01CA   3028           00168         movlw   B'00101000'     ;Interfaz de 4 bits, 2 lineas
01CB   2???           00169         call    ESCRIBIRCOMANDO         ; de caracteres de 5x7
                      00170         
01CC   300F           00171         movlw   on_display_cursor_blink     ;FH Display on, cursor on,blink
01CD   2???           00172         call    ESCRIBIRCOMANDO
                      00173         
01CE   3001           00174         movlw   limpiar_lcd             ; Limpia el LCD
01CF   2???           00175         call    ESCRIBIRCOMANDO
                      00176         
01D0   3006           00177         movlw   B'00000110'     ; Configura para que cada que se escriba un caracter cursor aumente en 1
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01D1   2???           00178         call    ESCRIBIRCOMANDO         
                      00179         
01D2   3080           00180         movlw   B'10000000'     ; Vamos a HOME
01D3   2???           00181         call    ESCRIBIRCOMANDO
01D4   0008           00182         RETURN
                      00183 
                      00184 ;//////////////////////////////////////////////////////////////
                      00185 ;///// Comandos para escribir en el LCD un registro de 3 dígitos
                      00186 
01D5                  00187 PARAESCR1B1RREGISTRO            ;título de subrutina
01D5   00AF           00188         MOVWF Varregcomp                        ;Guarda el valor de ingreso en un Registro
                      00189         convertir_a_bcd Varregcomp  ;Separa en 3 registros (dígitos)el valor
01D6   082F               M         MOVF Varregcomp,0
01D7   2???               M         CALL binario_a_bcd
                      00190         
                      00191         ;Para valores inferiores a 10
01D8   300A           00192         MOVLW d'10'           ;Carga el valor de 10 en una variable    
01D9   022F           00193         SUBWF Varregcomp,0    ;De comparación.
01DA   1C03           00194         BTFSS STATUS,C        ;El resultado es de 1 dígito?
01DB   2???           00195         GOTO UND1G            ;Caso verdadero subrutina para escribir 1 digito
01DC   3064           00196         MOVLW d'100'          ;Carga el valor de 100 en una variable
01DD   022F           00197         SUBWF Varregcomp,0    ;De comparación 
01DE   1C03           00198         BTFSS STATUS,C        ;El resultado es de dos digitos?
01DF   2???           00199         GOTO D0SDIG           ;Caso verdadero subrutina de escribir 2 digitos
01E0   30FF           00200         MOVLW d'255'          ;Carga el valor de 100 en una
01E1   022F           00201         SUBWF Varregcomp,0        ;En una variable de comparación       
01E2   1C03           00202         BTFSS STATUS,C            ;El resultado es mayor a 200?
01E3   2???           00203         GOTO TRESD1G          ;Caso falso. Va a la subrutina de escribir 3 dig   
                      00204         escribir 'O'          ;Caso verdadero, empieza a escribir un mensaje
01E4   304F               M            movlw 'O'
01E5   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
                      00205         escribir 'U'
01E6   3055               M            movlw 'U'
01E7   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
                      00206         escribir 'T'
01E8   3054               M            movlw 'T'
01E9   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
Warning[207]: Found label after column 1. (FUERALIM1T3)
01EA                  00207         FUERALIM1T3           ;título de finalización de subrutina
01EA   0008           00208         RETURN           ; <------- El return está ahí
                      00209         
Warning[207]: Found label after column 1. (UND1G)
01EB                  00210         UND1G                      ;Subrutina para escribir 1 dígito
                      00211         escribir ' '           ;Escribe 2 espacios 
01EB   3020               M            movlw ' '
01EC   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
                      00212         escribir ' '
01ED   3020               M            movlw ' '
01EE   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
                      00213         escribirreg bcd_unidad ;Escribe el digito
01EF   3030               M          movlw .48
01F0   0734               M         addwf bcd_unidad,0
01F1   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01F2   2???           00214         GOTO FUERALIM1T3       ;Se va a finalizar la subrutina 
Warning[207]: Found label after column 1. (D0SDIG)
01F3                  00215         D0SDIG                 ;Subrutina para escribir 2 dígitos 
                      00216         escribir ' '           ;Escribe un espacio  
01F3   3020               M            movlw ' '
01F4   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
                      00217         escribirreg bcd_decena ;Escribe el penúltimo digito
01F5   3030               M          movlw .48
01F6   0735               M         addwf bcd_decena,0
01F7   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
                      00218         escribirreg bcd_unidad ;Escribe el último digito
01F8   3030               M          movlw .48
01F9   0734               M         addwf bcd_unidad,0
01FA   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
01FB   2???           00219         GOTO FUERALIM1T3       ;Se va a finalizar la subrutina
Warning[207]: Found label after column 1. (TRESD1G)
01FC                  00220         TRESD1G                ;Subrutina para escribir 3 dígitos
                      00221         escribirreg bcd_centena;Escribe el antepenúltimo digito
01FC   3030               M          movlw .48
01FD   0736               M         addwf bcd_centena,0
01FE   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
                      00222         escribirreg bcd_decena ;Escribe el penúltimo digito
01FF   3030               M          movlw .48
0200   0735               M         addwf bcd_decena,0
0201   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
                      00223         escribirreg bcd_unidad ;Escribe el penúltimo digito
0202   3030               M          movlw .48
0203   0734               M         addwf bcd_unidad,0
0204   2???               M          call  ESCRIBIRCARACTER   ;Subrutina en la librería que me permite enviar el valor
0205   2???           00224         GOTO FUERALIM1T3       ;Se va a finalizar la subrutina 
                      00225 ;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
                      00226 ;\\\\\\\\\\\\\\\\\\\\\\\Subrutina para borrar fila \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
                      00227         
Warning[207]: Found label after column 1. (subp4arab0rf1l)
0206                  00228         subp4arab0rf1l
                      00229         cargarvalor .16,indice
0206   3010               M         MOVLW .16
0207   00A9               M         MOVWF indice
                      00230         escribir ' '
0208   3020               M            movlw ' '
0209   2???               M            call  ESCRIBIRCARACTER  ;Subrutina en la librería que me permite enviar el caracter
020A   0BA9           00231         DECFSZ indice,1
020B   2???           00232         GOTO $-2        
020C   0008           00233         RETURN
                      00234 ;................... Descarga la actualizaciones en: www.rodrigocarita.com      
Warning[205]: Found directive in column 1. (INCLUDE)
                      00172 INCLUDE <Retardos.asm>  ;Incluimos la librería de retardos v 1.0
                      00001 ;::::::::::::: www.rodrigocarita.com ::::::::::::::::::::::::::
                      00002 ;                       Retardos.asm   Versión: 1.0
                      00003 
                      00004 ; Librería de retardos por bucles anidados.
                      00005 ; 
                      00006 ;             Se utiliza con la Macro.inc
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00007 ; milisegundo .2   -> Genera un retardo de 2 milisegundos
                      00008 ; Segundo .6 -> Genera un retardo de 6 segundos
                      00009 ; Los valores deben estar entre 0 a 255.
                      00010 
                      00011         cblock                          
  00000030            00012         memo_tiemp_1        
  00000031            00013         memo_tiemp_2        
  00000032            00014         memo_tiemp_3        
  00000033            00015         memo_tiemp_4
                      00016         endc
                      00017 
020D                  00018 milisegundos
020D   00B0           00019          movwf  memo_tiemp_1
Warning[207]: Found label after column 1. (retbucle1)
020E                  00020     retbucle1
020E   3011           00021          movlw  .17
020F   00B1           00022          movwf  memo_tiemp_2 
Warning[207]: Found label after column 1. (retbucle2)
0210                  00023     retbucle2
0210   303A           00024          movlw  .58
0211   00B2           00025          movwf  memo_tiemp_3     
Warning[207]: Found label after column 1. (retbucle3)
0212                  00026     retbucle3
0212   0000           00027          nop
0213   0000           00028          nop
0214   0BB2           00029          decfsz memo_tiemp_3,1     
0215   2???           00030          goto   retbucle3
0216   0BB1           00031          decfsz memo_tiemp_2,1
0217   2???           00032          goto   retbucle2
0218   0BB0           00033          decfsz memo_tiemp_1,1
0219   2???           00034          goto   retbucle1
Warning[203]: Found opcode in column 1. (RETURN)
021A   0008           00035 RETURN
021B                  00036 segundos
021B   00B0           00037          movwf  memo_tiemp_1
Warning[207]: Found label after column 1. (retbucle1a)
021C                  00038     retbucle1a
021C   30FA           00039          movlw  .250
021D   00B1           00040          movwf  memo_tiemp_2 
Warning[207]: Found label after column 1. (retbucle2a)
021E                  00041     retbucle2a
021E   30FA           00042          movlw  .250
021F   00B2           00043          movwf  memo_tiemp_3     
Warning[207]: Found label after column 1. (retbucle3a)
0220                  00044     retbucle3a
0220   3013           00045          movlw  .19
0221   00B3           00046          movwf  memo_tiemp_4 
Warning[207]: Found label after column 1. (retbucle4a)
0222                  00047     retbucle4a
0222   0000           00048          nop
0223   0BB3           00049          decfsz memo_tiemp_4,1 
0224   2???           00050          goto   retbucle4a
0225   0BB2           00051          decfsz memo_tiemp_3,1    
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0226   2???           00052          goto   retbucle3a
0227   0BB1           00053          decfsz memo_tiemp_2,1
0228   2???           00054          goto   retbucle2a
0229   0BB0           00055          decfsz memo_tiemp_1,1
022A   2???           00056          goto   retbucle1a
Warning[203]: Found opcode in column 1. (RETURN)
022B   0008           00057 RETURN
Warning[205]: Found directive in column 1. (INCLUDE)
                      00173 INCLUDE <conversor.asm> ;incluimos la librería conversor requerida por lcd  v 1.0
                      00001 ;:.:::::::::::::::::::::::  RodrigoCarita.com -::::::::::::::::::::::::::::::::
                      00002 ; Librería: conversor.asm
                      00003 ; Verisón: 1.0
                      00004 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Warning[205]: Found directive in column 1. (cblock)
                      00005 cblock
  00000034            00006 bcd_unidad
  00000035            00007 bcd_decena
  00000036            00008 bcd_centena
Warning[205]: Found directive in column 1. (ENDC)
                      00009 endc
                      00010 
022C                  00011 binario_a_bcd
022C   00B4           00012     MOVWF  bcd_unidad    ;Carga el número binario a convertir
022D   01B6           00013     CLRF   bcd_centena    ;Borra registro
022E   01B5           00014     CLRF   bcd_decena     ;Borra registro
022F                  00015 BCD_Resta10
022F   300A           00016     MOVLW  .10             ;A las unidades de les va restando
0230   0234           00017     SUBWF  bcd_unidad,0  ;10 en cada pasada 
0231   1C03           00018     BTFSS  STATUS,C        ;C=0? si- entonces bcd_unidad>=0
0232   2???           00019     GOTO   BIN_BCD_Fin     ;No- entonces se acabo  
0233                  00020 BCD_IncrementarDecenas     
0233   00B4           00021     MOVWF  bcd_unidad    ;Recupera lo que queda por restar
0234   0AB5           00022     INCF   bcd_decena,1   ;Incrementa las decenas 
0235   300A           00023     MOVLW  .10
0236   0235           00024     SUBWF  bcd_decena,0   ;Comprueba si a llegado a 10
0237   1C03           00025     BTFSS  STATUS,C        ;C=1? si- entonces bcd_decena>=0 
0238   2???           00026     GOTO   BCD_Resta10     ;No- entonces resta 10 a las unidades
0239                  00027 BCD_IncrementarCentenas
0239   01B5           00028     CLRF   bcd_decena     ;Pone a cero las decenas
023A   0AB6           00029     INCF   bcd_centena,1  ;Incrementa las centenas
023B   2???           00030     GOTO   BCD_Resta10     ;Resta 10 al número a convertir
023C                  00031 BIN_BCD_Fin
023C   0E35           00032     SWAPF  bcd_decena,0   ;Intercambia nibles
023D   0734           00033     ADDWF  bcd_unidad,0  ;Nible bajo=unidades / Nible alto=decenas
023E   0008           00034     RETURN
                      00035 
Warning[205]: Found directive in column 1. (END)
3F32                  00174 END
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 45


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
BCD_IncrementarCentenas           00000239
BCD_IncrementarDecenas            00000233
BCD_Resta10                       0000022F
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BIN_BCD_Fin                       0000023C
BRGH                              00000002
BoTt0Nn0                          00000122
BoTt0Nn1                          00000125
BoTt0Nn2                          00000128
BoTt0Nn3                          0000012B
BoTt0Nn4                          0000012E
BoTt0Nn5                          00000131
BoTt0Nn6                          00000134
BoTt0Nn7                          00000137
BoTt0Nn8                          0000013A
BoTt0Nn9                          0000013D
BoTt0NnA                          00000140
BoTt0NnAST                        0000014C
BoTt0NnB                          00000143
BoTt0NnC                          00000146
BoTt0NnD                          00000149
BoTt0NnMICH                       0000014F
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 46


SYMBOL TABLE
  LABEL                             VALUE 

CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
CKP                               00000004
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
COMPROBARSIOCUPADO                0000017C
CREN                              00000004
CSRC                              00000007
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
D0SDIG                            000001F3
DATA_ADDRESS                      00000005
DATOS                             00000008
DC                                00000001
DENEGADO                          00000047
D_A                               00000005
D_NOT_A                           00000005
E                                 00000003
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 47


SYMBOL TABLE
  LABEL                             VALUE 

EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
ESCRIBEPARTE2                     0000008D
ESCRIBEPARTE3                     000000A2
ESCRIBETITULO                     0000007A
ESCRIBIRCARACTER                  00000165
ESCRIBIRCOMANDO                   00000152
F                                 00000001
FERR                              00000002
FSR                               00000004
FUERALIM1T3                       000001EA
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
Hhayrt3cla                        00000027
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
IN1ci0t3cla4do                    000000B9
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
Inicio_lcd                        0000019C
LLAVE                             PORTC,1
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
NumCadena                         00000028
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PARAESCR1B1RREGISTRO              000001D5
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 48


SYMBOL TABLE
  LABEL                             VALUE 

PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PERMITIDO                         00000056
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PROGRAMA                          0000000D
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
PUERTA                            PORTC,6
PULSOSUB                          
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 49


SYMBOL TABLE
  LABEL                             VALUE 

RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RS                                00000001
RSEN                              00000001
RW                                00000002
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SEN                               00000000
SETF                              
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 50


SYMBOL TABLE
  LABEL                             VALUE 

SYNC                              00000004
SinTecl4                          0000011D
Sit3cl4pus                        00000026
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRESD1G                           000001FC
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 51


SYMBOL TABLE
  LABEL                             VALUE 

TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
Tttest3aTecld0o                   000000C3
UA                                00000001
UND1G                             000001EB
Varregcomp                        0000002F
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_.org_0_0058                      00000058
_.org_0_005B                      0000005B
_.org_0_020B                      0000020B
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_CP_ON                            00001FFF
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 52


SYMBOL TABLE
  LABEL                             VALUE 

_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877A                         00000001
apagar                            
apagar_el_display                 00000008
apagarpantalla                    
banco                             
bcd_centena                       00000036
bcd_decena                        00000035
bcd_unidad                        00000034
binario_a_bcd                     0000022C
borralcd                          
borrarfila                        
c0mpparadD0r                      00000025
caractertemp                      0000002C
cargarvalor                       
convertir_a_bcd                   
copiarregistro                    
crearreg                          
csi                               
csir                              
csni                              
csnir                             
cursor_derecha                    
cursor_izquierda                  
cursor_off                        
cursor_on                         
desplazaderecha                   
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 53


SYMBOL TABLE
  LABEL                             VALUE 

desplazaizquierda                 
encender                          
encenderpantalla                  
enviaradisplay                    
enviarcdisplay                    
escribir                          
escribirmensaje                   
escribirreg                       
escribirregistro                  
fila_enter                        
fila_home                         
home_inicio                       00000002
indice                            00000029
iniciar_hcsr04                    
iniciar_teclado                   
iniciarlcd                        
ir_a_fila                         
irsitecla                         
lcdfc                             
leertecla                         
limpiar_lcd                       00000001
llamarsitecla                     
mayorque                          
mayorquereg                       
medir_ultrasonico                 
memo_tiemp_1                      00000030
memo_tiemp_2                      00000031
memo_tiemp_3                      00000032
memo_tiemp_4                      00000033
memocaracter                      0000002A
memoriaw                          0000002B
menorque                          
menorquereg                       
mensaje                           
milisegundo                       
milisegundos                      0000020D
mover_cursor_derecha              00000014
mover_cursor_izquierda            00000010
mover_pantalla_derecha            0000001C
mover_pantalla_izquierda          00000018
multiplicarreg                    
off                               00000000
on                                00000001
on_display_cursor_blink           0000000F
on_lib_retardos_ms                
pinlcd                            00000008
puertoa                           00000005
puertob                           00000006
puertoc                           00000007
puertod                           00000008
puertoe                           00000009
registroadisplay                  
registrocdisplay                  
MPASM 5.56                S18-CERRADURAE.ASM   4-29-2020  20:04:55         PAGE 54


SYMBOL TABLE
  LABEL                             VALUE 

restarreg                         
retardo_ms                        
retbucle1                         0000020E
retbucle1a                        0000021C
retbucle2                         00000210
retbucle2a                        0000021E
retbucle3                         00000212
retbucle3a                        00000220
retbucle4a                        00000222
salto_enter                       000000C0
segundo                           
segundos                          0000021B
solo_display                      0000000C
subp4arab0rf1l                    00000206
sumarreg                          
teclapulsada                      00000020
teclapulsada2                     00000021
teclapulsada3                     00000022
teclapulsada4                     00000023
tekl4pul5                         00000024
ubicacionlcdccr                   0000002E
ubicacionlcdfcr                   0000002D

Errors   :     0
Warnings :   311 reported,     0 suppressed
Messages :    10 reported,     0 suppressed

